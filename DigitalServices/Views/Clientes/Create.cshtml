@model DigitalServices.Models.Clientes

@{
    ViewBag.Title = "Create";
}

<h2>Create</h2>


@using (Html.BeginForm()) 
{
    @Html.AntiForgeryToken()
    
    <div class="form-horizontal ">
        <h4>Clientes</h4>
        <hr />
        <div class="form-group">
            <div class="input-group">
                <span class="input-group-addon">Id:</span>
                <input class="form-control input-group input" type="text" placeholder="Identificador" id="inpId" />
                <button class="btn btn-group-sm btn-success" type="button" id="btnBuscar" onclick="">Buscar</button>
            </div>
        </div>
        <div class="form-group">
            <div class="input-group col-lg-12">
                <span class="input-group-addon glyphicon glyphicon-user"> Nombres</span>
                <input id="inpNombres" class="form-control input-group-sm col-1 " type="text" name="Nombres" placeholder="Nombres" />
            </div>
        </div>
        
        <div class="form-group">
            <div class="input-group">
                <span class="input-group-addon">Direcciòn:</span>
                <input class="form-control input-group input" type="text" placeholder="Direcciòn" id="inpDireccion" />
            </div>
        </div>
        <div class="form-group">
            <div class="input-group">
                <span class="input-group-addon">Email:</span>
                <input class="form-control input-group input" type="text" placeholder="Correo electrònico" id="inpEmail" />
            </div>
        </div>
        <div class="form-group">
            <div class="input-group">
                <span class="input-group-addon">Telèfono:</span>
                <input class="form-control input-group input" type="text" placeholder="Telefono" id="inpTelefono" />
            </div>
        </div>
        <div class="form-group text-center col-xl-12">
            <div class="col-md-offset-2 col-md-10">
                <button type="button" class="btn btn-outline-info col-sm-2" id="btnLimpiar" onclick="LimpiarCampos()">Nuevo</button>
                <button type="button" class="btn btn-outline-success col-sm-2" id="btnCrear" onclick="ArmarCliente(1)">Crear</button>
                <button type="button" class="btn btn-outline-warning col-sm-2" id="btnModificar" onclick="ArmarCliente(2)">Modificar</button>
                <button type="button" class="btn btn-outline-danger col-sm-2" id="btnEliminar" onclick="ArmarCliente(3)">Eliminar</button>
            </div>
        </div>
    </div>
}

<div>
    @Html.ActionLink("Back to List", "Index")
</div>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script src="http://code.google.com/p/jquery-ui/source/browse/branches/labs/datepicker2/ui/i18n/jquery.ui.datepicker-es.js?r=3875"></script>
    <script src="~/Scripts/bootstrap.js"></script>
    <script type="text/javascript">
        function ArmarCliente(motivo)
        {
            var id = $('#inpId').val();
            var nombre = $('#inpNombres').val();
            var direccion = $('#inpDirecciones').val();
            var email = $('#inpEmail').val();
            var telf = $('#inpTelefono').val();

            var cliente = {
                IdCliente: id,
                Nombres: nombre,
                Direccion: direccion,
                Email: email,
                Telefono: telf
            };

            if (modo == 1) {
                CrearCliente(cliente);
            } else if (modo == 2)
            {
                ModificarCliente(cliente);
            } else if (modo == 3)
            {
                EliminarCliente(cliente);
            }
        }
        function CrearCliente(cliente)
        {
            $.ajax({
                type: "POST",
                contentType: "application/json; charset=utf-8",
                url: "/Clientes/Guardar",
                data: JSON.stringify(cliente),
                success: function (resultado) {
                    if (resultado)
                    {
                        alert("El cliente fue registrado exitosamente.")
                    }
                    else
                    {
                        alert("No se pudo procesar su solicitud");
                    }
                    LimpiarCampos();
                },
                error: function (error)
                {
                    console.log(error);
                }
            })
        }
        function ModificarCliente(cliente)
        {
            $.ajax({
                type: "POST",
                contentType: "application/json; charset=utf-8",
                url: "/Clientes/Modificar",
                data: JSON.stringify(cliente),
                success: function (resultado) {
                    if (resultado)
                    {
                        alert("El cliente ha sido modificado.");
                    }
                    else
                    {
                        alert("Su solicitud no ha podido ser procesada");
                    }
                    LimpiarCampos();
                }
            })
        }
        function EliminarCliente(cliente) {
            $.ajax({
                type: "POST",
                contentType: "application/json; charset=utf-8",
                url: "/Clientes/Eliminar",
                data: JSON.stringify(cliente),
                success: function (resultado)
                {
                    if (resultado) {
                        alert("El cliente ha sido eliminado");
                    }
                    else
                    {
                        alert("La solicitud no ha podido ser procesada");
                    }
                    LimpiarCampos();
                }
            })
        }

        function LimpiarCampos()
        {
            $('#inpId').val("");
            $('#inpNombres').val("");
            $('#inpDirecciones').val("");
            $('#inpEmail').val("");
            $('#inpTelefono').val("");
        }
    </script>
}
